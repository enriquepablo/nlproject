

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Example: A content management system &mdash; nlproject v1.0dev documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="nlproject v1.0dev documentation" href="index.html" />
    <link rel="up" title="Documentation for nl" href="nl_intro.html" />
    <link rel="next" title="Documentation for nlserv" href="nlserv.html" />
    <link rel="prev" title="Counting Sentences" href="counting.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nlserv.html" title="Documentation for nlserv"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="counting.html" title="Counting Sentences"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">nlproject v1.0dev documentation</a> &raquo;</li>
          <li><a href="nl_intro.html" accesskey="U">Documentation for nl</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="example-a-content-management-system">
<h1>Example: A content management system<a class="headerlink" href="#example-a-content-management-system" title="Permalink to this headline">Â¶</a></h1>
<p>In this section we will try to develop a more complex ontology that might be used as the metadata backend for a content management system (CMS). Such a CMS would basically consist of the following parts:</p>
<blockquote>
<ol class="arabic simple">
<li>A web application: mainly an HTTP request dispatcher and a system of views that the dispatcher calls to get responses for the requests;</li>
<li>A database where actual content (text, images, etc.) is stored;</li>
<li>A user authentication backend;</li>
<li>The metadata backend that the views consult to produce responses.</li>
</ol>
</blockquote>
<p>The metadata backend would therefore know about content types, users, permissions, workflows, etc., and is the only part we will develop here.</p>
<p>So let&#8217;s start by defining a &#8220;person&#8221; noun:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">Thing</span><span class="p">):</span> <span class="k">pass</span>
</pre></div>
</div>
<p>The first verb that affects people that we are going to define is &#8220;wants&#8221;: Whenever a user attempts to perform an action on the system (calls a URL, clicks a button, etc.), we will tell the metadata backend (nl) that the user wants to perform the action. A basic pattern for the metadata rules will be &#8220;if someone wants to do such thing, and this and that conditions are met, (s)he does such thing&#8221;. Therefore, a basic pattern for the views will be to tell nl that a user wants to do something, extend the knowledge base, and then ask whether the user does it. We might have developed an alternative ontology using &#8220;can&#8221;, defining a basic rule with the form &#8220;if someone wants to do X, and can do X, then (s)he does X&#8221;, and afterwards defining rules with a basic pattern &#8220;if such and such conditions are met, user X can do Y&#8221;. This alternative ontology would be much less efficient, though, since we would end up with loads and loads of (possibly useless) sentences with the form &#8220;user X can do Y with content Z&#8221;.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Wants</span><span class="p">(</span><span class="n">Exists</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">subject</span> <span class="o">=</span> <span class="n">Person</span>
<span class="gp">... </span>    <span class="n">mods</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;what&#39;</span><span class="p">:</span> <span class="n">Exists</span><span class="p">}</span>
</pre></div>
</div>
<p>We need a &#8220;content&#8221; class of things. <tt class="docutils literal"><span class="pre">Content</span></tt> will be the noun of all content objects, and the various content types (e.g., document) will be classes derived from <tt class="docutils literal"><span class="pre">Content</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Content</span><span class="p">(</span><span class="n">Thing</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Document</span><span class="p">(</span><span class="n">Content</span><span class="p">):</span> <span class="k">pass</span>
</pre></div>
</div>
<p>Now we define a fairly general verb, <tt class="docutils literal"><span class="pre">Has</span></tt>, that can have anything as subject and can have two modifiers, <tt class="docutils literal"><span class="pre">what</span></tt>, that can be any thing, and <tt class="docutils literal"><span class="pre">where</span></tt>, that has to be a context:</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Context</span><span class="p">(</span><span class="n">Thing</span><span class="p">):</span> <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Has</span><span class="p">(</span><span class="n">Exists</span><span class="p">):</span>
<span class="gp">... </span>     <span class="n">subject</span> <span class="o">=</span> <span class="n">Thing</span>
<span class="gp">... </span>     <span class="n">mods</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;what&#39;</span><span class="p">:</span> <span class="n">Thing</span><span class="p">,</span>
<span class="gp">... </span>             <span class="s">&#39;where&#39;</span><span class="p">:</span> <span class="n">Context</span><span class="p">}</span>
</pre></div>
</div>
</blockquote>
<p>We will use <tt class="docutils literal"><span class="pre">Has</span></tt> for various things. For example, to tell the system that a certain user has a certain role in some context, or that a certain role has a certain permission, or that a certain content object has some workflow state.</p>
<p>Next, let&#8217;s define 2 nouns: role and permission. As we have hinted above, roles are related with permissions through the verb &#8220;has&#8221;. And, since it will be fairly common to assert that a given role has a certain permission, we will provide a utility <a class="reference external" href="http://www.python.org/">Python</a> method to establish that relationship.</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Permission</span><span class="p">(</span><span class="n">Thing</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Role</span><span class="p">(</span><span class="n">Thing</span><span class="p">):</span> <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">role_has_perm</span><span class="p">(</span><span class="n">role</span><span class="p">,</span> <span class="n">perm</span><span class="p">):</span>
<span class="go">        kb.tell( Fact(role, Has(what=perm), Duration(start=&#39;now&#39;)) )</span>
</pre></div>
</div>
</blockquote>
<p>We could now start to define a few proper names for our ontology:</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">member</span> <span class="o">=</span> <span class="n">Role</span><span class="p">(</span><span class="s">&#39;member&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">editor</span> <span class="o">=</span> <span class="n">Role</span><span class="p">(</span><span class="s">&#39;editor&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manager</span> <span class="o">=</span> <span class="n">Role</span><span class="p">(</span><span class="s">&#39;manager&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">editor</span><span class="p">,</span> <span class="n">member</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">basic_context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="s">&#39;basic_context&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">basic_context</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">view_perm</span> <span class="o">=</span> <span class="n">Permission</span><span class="p">(</span><span class="s">&#39;view_perm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">edit_perm</span> <span class="o">=</span> <span class="n">Permission</span><span class="p">(</span><span class="s">&#39;edit_perm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">manage_perm</span> <span class="o">=</span> <span class="n">Permission</span><span class="p">(</span><span class="s">&#39;manage_perm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">manage_perm</span><span class="p">,</span> <span class="n">edit_perm</span><span class="p">,</span> <span class="n">view_perm</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">role_has_perm</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">view_perm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">role_has_perm</span><span class="p">(</span><span class="n">editor</span><span class="p">,</span> <span class="n">view_perm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">role_has_perm</span><span class="p">(</span><span class="n">editor</span><span class="p">,</span> <span class="n">edit_perm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">role_has_perm</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">view_perm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">role_has_perm</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">edit_perm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">role_has_perm</span><span class="p">(</span><span class="n">manager</span><span class="p">,</span> <span class="n">manage_perm</span><span class="p">)</span>
</pre></div>
</div>
</blockquote>
<p>We can now assert that, for whichever context, the admin person has the manager role:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Rule</span><span class="p">([</span>
<span class="gp">... </span>    <span class="n">Context</span><span class="p">(</span><span class="s">&#39;X1&#39;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">],[</span>
<span class="gp">... </span>    <span class="n">Fact</span><span class="p">(</span><span class="n">admin</span><span class="p">,</span> <span class="n">Has</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">manager</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">Context</span><span class="p">(</span><span class="s">&#39;X1&#39;</span><span class="p">)),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">&#39;now&#39;</span><span class="p">)),</span>
<span class="gp">... </span><span class="p">]))</span>
</pre></div>
</div>
<p>We now define a verb, <tt class="docutils literal"><span class="pre">Located</span></tt>, that allows us to locate content objects in contexts:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Located</span><span class="p">(</span><span class="n">Exists</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">subject</span> <span class="o">=</span> <span class="n">Content</span>
<span class="gp">... </span>    <span class="n">mods</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;where&#39;</span><span class="p">:</span> <span class="n">Context</span><span class="p">}</span>
</pre></div>
</div>
<p>Next, we define a <tt class="docutils literal"><span class="pre">Status</span></tt> noun, that refers to the different workflow states that a content object can be in. As a starting point, we shall define 2 different states, public and private:</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Status</span><span class="p">(</span><span class="n">Thing</span><span class="p">):</span> <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">public</span> <span class="o">=</span> <span class="n">Status</span><span class="p">(</span><span class="s">&#39;public&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">private</span> <span class="o">=</span> <span class="n">Status</span><span class="p">(</span><span class="s">&#39;private&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">public</span><span class="p">,</span> <span class="n">private</span><span class="p">)</span>
</pre></div>
</div>
</blockquote>
<p>And now, we will define verbs that refer to the different actions that people can perform with content objects. First, we define an abstract <tt class="docutils literal"><span class="pre">Action</span></tt> verb that will be the ancestor of any other action:</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Action</span><span class="p">(</span><span class="n">Exists</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">subject</span> <span class="o">=</span> <span class="n">Person</span>
<span class="gp">... </span>    <span class="n">mods</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;what&#39;</span><span class="p">:</span> <span class="n">Content</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">View</span><span class="p">(</span><span class="n">Action</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Edit</span><span class="p">(</span><span class="n">Action</span><span class="p">):</span> <span class="k">pass</span>
</pre></div>
</div>
</blockquote>
<p>We now define an abstract workflow action, that will be primitive to any workflow action:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">WfAction</span><span class="p">(</span><span class="n">Action</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Publish</span><span class="p">(</span><span class="n">WfAction</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Hide</span><span class="p">(</span><span class="n">WfAction</span><span class="p">):</span> <span class="k">pass</span>
</pre></div>
</div>
<p>Now we define a <tt class="docutils literal"><span class="pre">Required</span></tt> verb, that is used to state that a certain permission is required to perform a given action over any content that is in a certain workflow state. Note that in this case, we are using an actual verb, and not a predicate, as the modifier for the &#8220;required&#8221; verb: We define it with <tt class="docutils literal"><span class="pre">Verb</span></tt> in its <tt class="docutils literal"><span class="pre">mods</span></tt> dictionary. For the moment, we can not set bounds to the possible verbs that can be used as modifiers for these verbs: we use <tt class="docutils literal"><span class="pre">Verb</span></tt>, that is the only class we hav:e for verbs.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Required</span><span class="p">(</span><span class="n">Exists</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">subject</span> <span class="o">=</span> <span class="n">Permission</span>
<span class="gp">... </span>    <span class="n">mods</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;to&#39;</span><span class="p">:</span> <span class="n">Verb</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s">&#39;over&#39;</span><span class="p">:</span> <span class="n">Status</span><span class="p">}</span>
</pre></div>
</div>
<p>At this point, we can define a rule that, when someone wants to perform an action over some content, decides whether (s)he is allowed to perform it or not, according to her roles and to the workflow state of that content. We want to assert that, if someone wants to perform some action on some content, and that content has some state and is located in some context, and the person has some role in that context that has the required permission to perform that action over that workflow state, then (s)he performs it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Rule</span><span class="p">([</span>
<span class="gp">... </span>     <span class="n">Fact</span><span class="p">(</span><span class="n">Person</span><span class="p">(</span><span class="s">&#39;P1&#39;</span><span class="p">),</span> <span class="n">Wants</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="n">Verb</span><span class="p">(</span><span class="s">&#39;V1&#39;</span><span class="p">,</span> <span class="n">Action</span><span class="p">)(</span><span class="n">what</span><span class="o">=</span><span class="n">Content</span><span class="p">(</span><span class="s">&#39;C1&#39;</span><span class="p">))),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;I1&#39;</span><span class="p">)),</span>
<span class="gp">... </span>     <span class="n">Fact</span><span class="p">(</span><span class="n">Permission</span><span class="p">(</span><span class="s">&#39;M1&#39;</span><span class="p">),</span> <span class="n">Required</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="n">Verb</span><span class="p">(</span><span class="s">&#39;V1&#39;</span><span class="p">,</span> <span class="n">Action</span><span class="p">),</span> <span class="n">over</span><span class="o">=</span><span class="n">Status</span><span class="p">(</span><span class="s">&#39;S1&#39;</span><span class="p">)),</span> <span class="n">Duration</span><span class="p">(</span><span class="s">&#39;T5&#39;</span><span class="p">)),</span>
<span class="gp">... </span>     <span class="n">Fact</span><span class="p">(</span><span class="n">Content</span><span class="p">(</span><span class="s">&#39;C1&#39;</span><span class="p">),</span> <span class="n">Has</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">Status</span><span class="p">(</span><span class="s">&#39;S1&#39;</span><span class="p">)),</span> <span class="n">Duration</span><span class="p">(</span><span class="s">&#39;T1&#39;</span><span class="p">)),</span>
<span class="gp">... </span>     <span class="n">Fact</span><span class="p">(</span><span class="n">Content</span><span class="p">(</span><span class="s">&#39;C1&#39;</span><span class="p">),</span> <span class="n">Located</span><span class="p">(</span><span class="n">where</span><span class="o">=</span><span class="n">Context</span><span class="p">(</span><span class="s">&#39;X1&#39;</span><span class="p">)),</span> <span class="n">Duration</span><span class="p">(</span><span class="s">&#39;T2&#39;</span><span class="p">)),</span>
<span class="gp">... </span>     <span class="n">Fact</span><span class="p">(</span><span class="n">Person</span><span class="p">(</span><span class="s">&#39;P1&#39;</span><span class="p">),</span> <span class="n">Has</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">Role</span><span class="p">(</span><span class="s">&#39;R1&#39;</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">Context</span><span class="p">(</span><span class="s">&#39;X1&#39;</span><span class="p">)),</span> <span class="n">Duration</span><span class="p">(</span><span class="s">&#39;T3&#39;</span><span class="p">)),</span>
<span class="gp">... </span>     <span class="n">Fact</span><span class="p">(</span><span class="n">Role</span><span class="p">(</span><span class="s">&#39;R1&#39;</span><span class="p">),</span> <span class="n">Has</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">Permission</span><span class="p">(</span><span class="s">&#39;M1&#39;</span><span class="p">)),</span> <span class="n">Duration</span><span class="p">(</span><span class="s">&#39;T4&#39;</span><span class="p">)),</span>
<span class="gp">... </span>     <span class="n">During</span><span class="p">(</span><span class="s">&#39;I1&#39;</span><span class="p">,</span> <span class="s">&#39;T1&#39;</span><span class="p">,</span><span class="s">&#39;T2&#39;</span><span class="p">,</span><span class="s">&#39;T3&#39;</span><span class="p">,</span><span class="s">&#39;T4&#39;</span><span class="p">,</span> <span class="s">&#39;T5&#39;</span><span class="p">)</span>
<span class="gp">... </span> <span class="p">],[</span>
<span class="gp">... </span>     <span class="n">Fact</span><span class="p">(</span><span class="n">Person</span><span class="p">(</span><span class="s">&#39;P1&#39;</span><span class="p">),</span> <span class="n">Verb</span><span class="p">(</span><span class="s">&#39;V1&#39;</span><span class="p">,</span> <span class="n">Action</span><span class="p">)(</span><span class="n">what</span><span class="o">=</span><span class="n">Content</span><span class="p">(</span><span class="s">&#39;C1&#39;</span><span class="p">)),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;I1&#39;</span><span class="p">))]))</span>
</pre></div>
</div>
<p>Note the use of the <tt class="docutils literal"><span class="pre">V1</span></tt> verb variable to range over actual &#8220;action&#8221; verbs.</p>
<p>We can now define a utility funtion to assert that a given permission is required to perform a given action over content that is on a given workflow state, and use it to protect some actions with permissions:</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">r_permission</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">perm</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span> <span class="n">Fact</span><span class="p">(</span><span class="n">perm</span><span class="p">,</span> <span class="n">Required</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="n">action</span><span class="p">,</span> <span class="n">over</span><span class="o">=</span><span class="n">status</span><span class="p">),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">&#39;now&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">&#39;now&#39;</span><span class="p">))</span> <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r_permission</span><span class="p">(</span><span class="n">View</span><span class="p">,</span> <span class="n">public</span><span class="p">,</span> <span class="n">view_perm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_permission</span><span class="p">(</span><span class="n">Edit</span><span class="p">,</span> <span class="n">public</span><span class="p">,</span> <span class="n">edit_perm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_permission</span><span class="p">(</span><span class="n">Hide</span><span class="p">,</span> <span class="n">public</span><span class="p">,</span> <span class="n">manage_perm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_permission</span><span class="p">(</span><span class="n">View</span><span class="p">,</span> <span class="n">private</span><span class="p">,</span> <span class="n">manage_perm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_permission</span><span class="p">(</span><span class="n">Edit</span><span class="p">,</span> <span class="n">private</span><span class="p">,</span> <span class="n">manage_perm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_permission</span><span class="p">(</span><span class="n">Publish</span><span class="p">,</span> <span class="n">private</span><span class="p">,</span> <span class="n">manage_perm</span><span class="p">)</span>
</pre></div>
</div>
</blockquote>
<p>Next, we are going to give meaning to workflow actions. For that, we are going to define a <tt class="docutils literal"><span class="pre">Workflow</span></tt> noun, an <tt class="docutils literal"><span class="pre">Assigned</span></tt> verb that will relate workflows to content types (depending on the context the content object is in), and another verb <tt class="docutils literal"><span class="pre">HasTransition</span></tt> that relates a workflow with an initial and a final workflow state and the workflow action that performs the transition:</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Workflow</span><span class="p">(</span><span class="n">Thing</span><span class="p">):</span> <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Assigned</span><span class="p">(</span><span class="n">Exists</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">subject</span> <span class="o">=</span> <span class="n">Workflow</span>
<span class="gp">... </span>    <span class="n">mods</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;to&#39;</span><span class="p">:</span> <span class="n">Noun</span><span class="p">,</span> <span class="c">#Content</span>
<span class="gp">... </span>            <span class="s">&#39;where&#39;</span><span class="p">:</span> <span class="n">Context</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">HasTransition</span><span class="p">(</span><span class="n">Exists</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">subject</span> <span class="o">=</span> <span class="n">Workflow</span>
<span class="gp">... </span>    <span class="n">mods</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;start&#39;</span><span class="p">:</span> <span class="n">Status</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s">&#39;end&#39;</span><span class="p">:</span> <span class="n">Status</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s">&#39;by&#39;</span><span class="p">:</span> <span class="n">Verb</span><span class="p">}</span> <span class="c">#WfAction</span>
</pre></div>
</div>
</blockquote>
<p>With these terms in place, we can add a rule that states that, if some person performs some workflow action on some content, and that content is in the initial state of the transition corresponding to that action, and that action embodies the transition of some workflow that is assigned to the content type of the content object in the context in which the object is located, then the object ceases to be in the initial state and starts being in the final state of the transition:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Rule</span><span class="p">([</span>
<span class="gp">... </span>  <span class="n">Fact</span><span class="p">(</span><span class="n">Workflow</span><span class="p">(</span><span class="s">&#39;W1&#39;</span><span class="p">),</span> <span class="n">HasTransition</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">Status</span><span class="p">(</span><span class="s">&#39;S1&#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="n">Status</span><span class="p">(</span><span class="s">&#39;S2&#39;</span><span class="p">),</span> <span class="n">by</span><span class="o">=</span><span class="n">Verb</span><span class="p">(</span><span class="s">&#39;V1&#39;</span><span class="p">,</span> <span class="n">WfAction</span><span class="p">)),</span> <span class="n">Duration</span><span class="p">(</span><span class="s">&#39;T4&#39;</span><span class="p">)),</span>
<span class="gp">... </span>  <span class="n">Fact</span><span class="p">(</span><span class="n">Workflow</span><span class="p">(</span><span class="s">&#39;W1&#39;</span><span class="p">),</span> <span class="n">Assigned</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="n">Noun</span><span class="p">(</span><span class="s">&#39;N1&#39;</span><span class="p">,</span> <span class="n">Content</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">Context</span><span class="p">(</span><span class="s">&#39;X1&#39;</span><span class="p">)),</span> <span class="n">Duration</span><span class="p">(</span><span class="s">&#39;T2&#39;</span><span class="p">)),</span>
<span class="gp">... </span>  <span class="n">Fact</span><span class="p">(</span><span class="n">Noun</span><span class="p">(</span><span class="s">&#39;N1&#39;</span><span class="p">,</span> <span class="n">Content</span><span class="p">)(</span><span class="s">&#39;C1&#39;</span><span class="p">),</span> <span class="n">Located</span><span class="p">(</span><span class="n">where</span><span class="o">=</span><span class="n">Context</span><span class="p">(</span><span class="s">&#39;X1&#39;</span><span class="p">)),</span> <span class="n">Duration</span><span class="p">(</span><span class="s">&#39;T1&#39;</span><span class="p">)),</span>
<span class="gp">... </span>  <span class="n">Fact</span><span class="p">(</span><span class="n">Person</span><span class="p">(</span><span class="s">&#39;P1&#39;</span><span class="p">),</span> <span class="n">Verb</span><span class="p">(</span><span class="s">&#39;V1&#39;</span><span class="p">,</span> <span class="n">WfAction</span><span class="p">)(</span><span class="n">what</span><span class="o">=</span><span class="n">Noun</span><span class="p">(</span><span class="s">&#39;N1&#39;</span><span class="p">,</span> <span class="n">Content</span><span class="p">)(</span><span class="s">&#39;C1&#39;</span><span class="p">)),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;I1&#39;</span><span class="p">)),</span>
<span class="gp">... </span>  <span class="n">Fact</span><span class="p">(</span><span class="n">Noun</span><span class="p">(</span><span class="s">&#39;N1&#39;</span><span class="p">,</span> <span class="n">Content</span><span class="p">)(</span><span class="s">&#39;C1&#39;</span><span class="p">),</span> <span class="n">Has</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">Status</span><span class="p">(</span><span class="s">&#39;S1&#39;</span><span class="p">)),</span> <span class="n">Duration</span><span class="p">(</span><span class="s">&#39;T3&#39;</span><span class="p">)),</span>
<span class="gp">... </span>  <span class="n">During</span><span class="p">(</span><span class="s">&#39;I1&#39;</span><span class="p">,</span> <span class="s">&#39;T1&#39;</span><span class="p">,</span><span class="s">&#39;T2&#39;</span><span class="p">,</span> <span class="s">&#39;T3&#39;</span><span class="p">,</span> <span class="s">&#39;T4&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">],[</span>
<span class="gp">... </span>  <span class="n">Fact</span><span class="p">(</span><span class="n">Noun</span><span class="p">(</span><span class="s">&#39;N1&#39;</span><span class="p">)(</span><span class="s">&#39;C1&#39;</span><span class="p">),</span> <span class="n">Has</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">Status</span><span class="p">(</span><span class="s">&#39;S2&#39;</span><span class="p">)),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">Instant</span><span class="p">(</span><span class="s">&#39;I1&#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="n">MaxComEnd</span><span class="p">(</span><span class="s">&#39;T1&#39;</span><span class="p">,</span> <span class="s">&#39;T2&#39;</span><span class="p">))),</span>
<span class="gp">... </span>  <span class="n">Finish</span><span class="p">(</span><span class="s">&#39;T3&#39;</span><span class="p">,</span> <span class="s">&#39;I1&#39;</span><span class="p">)]))</span>
</pre></div>
</div>
<p>So, let&#8217;s provide a function to define transitions, and a workflow for <tt class="docutils literal"><span class="pre">Document</span></tt> and assign it to <tt class="docutils literal"><span class="pre">Document</span></tt> in the basic context, and a couple of transitions for that workflow:</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">r_transition</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">workflow</span><span class="p">,</span> <span class="n">initial</span><span class="p">,</span> <span class="n">final</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span> <span class="n">Fact</span><span class="p">(</span><span class="n">workflow</span><span class="p">,</span> <span class="n">HasTransition</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">initial</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">final</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="n">action</span><span class="p">),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">&#39;now&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">&#39;now&#39;</span><span class="p">))</span> <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">doc_workflow</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span><span class="s">&#39;doc_workflow&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">doc_workflow</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span> <span class="n">Fact</span><span class="p">(</span><span class="n">doc_workflow</span><span class="p">,</span> <span class="n">Assigned</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="n">Document</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">basic_context</span><span class="p">),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">))))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r_transition</span><span class="p">(</span><span class="n">Publish</span><span class="p">,</span> <span class="n">doc_workflow</span><span class="p">,</span> <span class="n">private</span><span class="p">,</span> <span class="n">public</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_transition</span><span class="p">(</span><span class="n">Hide</span><span class="p">,</span> <span class="n">doc_workflow</span><span class="p">,</span> <span class="n">public</span><span class="p">,</span> <span class="n">private</span><span class="p">)</span>
</pre></div>
</div>
</blockquote>
<p>With all this, we can start adding people and content objects, and test our ontology so far.</p>
<p>So, let&#8217;s star using this ontology. We are going to define 2 contexts, 2 documents, one located in each context, both with an initial state private, and two people, each with the manager and editor role in opposite contexts.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">john</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="s">&#39;john&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mary</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="s">&#39;mary&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context_of_john</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="s">&#39;context_of_john&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context_of_mary</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="s">&#39;context_of_mary&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc_of_john</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="s">&#39;doc_of_john&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc_of_mary</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="s">&#39;doc_of_mary&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">mary</span><span class="p">,</span> <span class="n">context_of_john</span><span class="p">,</span> <span class="n">context_of_mary</span><span class="p">,</span> <span class="n">doc_of_john</span><span class="p">,</span> <span class="n">doc_of_mary</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s start time:</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">now</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">Has</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">manager</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">context_of_john</span><span class="p">),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">Has</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">editor</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">context_of_mary</span><span class="p">),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">mary</span><span class="p">,</span> <span class="n">Has</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">manager</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">context_of_mary</span><span class="p">),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">mary</span><span class="p">,</span> <span class="n">Has</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">editor</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">context_of_john</span><span class="p">),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">doc_of_john</span><span class="p">,</span> <span class="n">Located</span><span class="p">(</span><span class="n">where</span><span class="o">=</span><span class="n">context_of_john</span><span class="p">),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">doc_of_john</span><span class="p">,</span> <span class="n">Has</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">private</span><span class="p">),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">doc_of_mary</span><span class="p">,</span> <span class="n">Located</span><span class="p">(</span><span class="n">where</span><span class="o">=</span><span class="n">context_of_mary</span><span class="p">),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">doc_of_mary</span><span class="p">,</span> <span class="n">Has</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">private</span><span class="p">),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
</pre></div>
</div>
</blockquote>
<p>We extend the knowledge base:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">extend</span><span class="p">()</span>
</pre></div>
</div>
<p>And now we can see that Mary cannot view or edit John&#8217;s document, but john can:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">mary</span><span class="p">,</span> <span class="n">Wants</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">View</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_john</span><span class="p">)),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">mary</span><span class="p">,</span> <span class="n">Wants</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">Edit</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_john</span><span class="p">)),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">Wants</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">View</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_john</span><span class="p">)),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">Wants</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">Edit</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_john</span><span class="p">)),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">extend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">mary</span><span class="p">,</span> <span class="n">View</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_john</span><span class="p">),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">mary</span><span class="p">,</span> <span class="n">Edit</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_john</span><span class="p">),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">View</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_john</span><span class="p">),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">Edit</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_john</span><span class="p">),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Time passes:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">now</span><span class="p">()</span>
</pre></div>
</div>
<p>Mary cannot publish John&#8217;s doc, but John can:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">mary</span><span class="p">,</span> <span class="n">Wants</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">Publish</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_john</span><span class="p">)),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">Wants</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">Publish</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_john</span><span class="p">)),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">extend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">mary</span><span class="p">,</span> <span class="n">Publish</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_john</span><span class="p">),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">Publish</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_john</span><span class="p">),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>And, now, john&#8217;s document is in the public state, and so, Mary can view it, but Mary&#8217;s is private and John cannot view it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">doc_of_john</span><span class="p">,</span> <span class="n">Has</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">public</span><span class="p">),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">mary</span><span class="p">,</span> <span class="n">Wants</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">View</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_john</span><span class="p">)),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">Wants</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">View</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_mary</span><span class="p">)),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">extend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">mary</span><span class="p">,</span> <span class="n">View</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_john</span><span class="p">),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">View</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">doc_of_mary</span><span class="p">),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;now&#39;</span><span class="p">)))</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Etc. etc.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="counting.html"
                        title="previous chapter">Counting Sentences</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="nlserv.html"
                        title="next chapter">Documentation for nlserv</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/cms.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nlserv.html" title="Documentation for nlserv"
             >next</a> |</li>
        <li class="right" >
          <a href="counting.html" title="Counting Sentences"
             >previous</a> |</li>
        <li><a href="index.html">nlproject v1.0dev documentation</a> &raquo;</li>
          <li><a href="nl_intro.html" >Documentation for nl</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Enrique Pablo PÃ©rez Arnaud &lt;enriquepablo at google&#39;s mail domain&gt;.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0b2.
    </div>
  </body>
</html>