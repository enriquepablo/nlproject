

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Arithmetics &mdash; nlproject v1.0dev documentation</title>
    <link rel="stylesheet" href="static/default.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="nlproject v1.0dev documentation" href="index.html" />
    <link rel="up" title="Documentation for nl" href="nl_intro.html" />
    <link rel="next" title="More special conditions" href="special_conditions.html" />
    <link rel="prev" title="Rules - basic" href="rules.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="special_conditions.html" title="More special conditions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="rules.html" title="Rules - basic"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">nlproject v1.0dev documentation</a> &raquo;</li>
          <li><a href="nl_intro.html" accesskey="U">Documentation for nl</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="arithmetics">
<h1>Arithmetics<a class="headerlink" href="#arithmetics" title="Permalink to this headline">¶</a></h1>
<p>We have already seen, in the section speaking about predicates, that we can use <tt class="docutils literal"><span class="pre">Number</span></tt> to use numbers. But we are not restricted to simple integers when using <tt class="docutils literal"><span class="pre">Number</span></tt>: we can also use arithmetic operations (with &#8220;parenthesized&#8221; polish notation, rooted in the internal use of <a class="reference external" href="http://clipsrules.sourceforge.net/">CLIPS</a>). For example, we might have:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">Number</span><span class="p">(</span><span class="s">&#39;(+ 2 3)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n2</span> <span class="o">=</span> <span class="n">Number</span><span class="p">(</span><span class="s">&#39;(+ 2 (* 5 6))&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can&#8217;t use this as a calculator, though; after all, this is <a class="reference external" href="http://www.python.org/">Python</a>, and <a class="reference external" href="http://www.python.org/">Python</a> is in itself enough of a calculator. So, if we resolve <tt class="docutils literal"><span class="pre">n</span></tt> to a string, we will get the actual operation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">&#39;(+ 2.0 3.0)&#39;</span>
</pre></div>
</div>
<p>As you can see, I am at the moment using floats in <a class="reference external" href="http://clipsrules.sourceforge.net/">CLIPS</a>, which I tend to think is a mistake, so for the moment I am leaving floats out of the official API.</p>
<p>Arithmetics in nl is intended to be used whithin rules. So, for example, using the <tt class="docutils literal"><span class="pre">Runs</span></tt> verb defined in the section on verbs and predicates, and defining a <tt class="docutils literal"><span class="pre">Displaces</span></tt> verb defined as follows, we might have a rule such as the following:</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Displaces</span><span class="p">(</span><span class="n">Exists</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">subject</span> <span class="o">=</span> <span class="n">HumanBeing</span>
<span class="gp">... </span>    <span class="n">mods</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;d&#39;</span><span class="p">:</span> <span class="n">Number</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r4</span> <span class="o">=</span> <span class="n">Rule</span><span class="p">([</span><span class="n">Fact</span><span class="p">(</span><span class="n">HumanBeing</span><span class="p">(</span><span class="s">&#39;H1&#39;</span><span class="p">),</span> <span class="n">Runs</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="s">&#39;V1&#39;</span><span class="p">),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">&#39;T1&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">&#39;T2&#39;</span><span class="p">)),</span>
<span class="gp">... </span>     <span class="p">],[</span>
<span class="gp">... </span>     <span class="n">Fact</span><span class="p">(</span><span class="n">HumanBeing</span><span class="p">(</span><span class="s">&#39;H1&#39;</span><span class="p">),</span> <span class="n">Displaces</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="s">&#39;(* V1 (- T2 T1))&#39;</span><span class="p">),</span> <span class="n">Instant</span><span class="p">(</span><span class="s">&#39;T2&#39;</span><span class="p">))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">r4</span><span class="p">)</span>
</pre></div>
</div>
</blockquote>
<p>Now we can do something like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">mary</span><span class="p">,</span> <span class="n">Runs</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">4</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">extend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">mary</span><span class="p">,</span> <span class="n">Displaced</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="mi">16</span><span class="p">),</span> <span class="n">Instant</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>At the moment, all arithmetic operations are binary, and we can only use the following operators (more to come, it&#8217;s in the TODO list to allow all arithmetics provided by <a class="reference external" href="http://clipsrules.sourceforge.net/">CLIPS</a>):</p>
<blockquote>
<ul class="simple">
<li>addition: <tt class="docutils literal"><span class="pre">+</span></tt>;</li>
<li>substraction: <tt class="docutils literal"><span class="pre">-</span></tt>;</li>
<li>multiplication: <tt class="docutils literal"><span class="pre">*</span></tt>;</li>
<li>division: <tt class="docutils literal"><span class="pre">/</span></tt>;</li>
<li>power: <tt class="docutils literal"><span class="pre">**</span></tt>.</li>
</ul>
</blockquote>
<p><em>NOTE</em>
As we have seen, we can mix instants and numbers in arithmetic operations. There is a caveat here, though: if we use &#8220;now&#8221; as the end instant of a duration, and use it in rules that use that duration arithmetically, we shall certainly get unexpected results. This is an unsolved problem at the moment, and the only current solution is not to mix those features.</p>
<div class="section" id="arithetic-conditions">
<h2>Arithetic conditions<a class="headerlink" href="#arithetic-conditions" title="Permalink to this headline">¶</a></h2>
<p>We can also use arithmetics to establish conditions in rules. To do so, we must import <tt class="docutils literal"><span class="pre">Arith</span></tt> from <tt class="docutils literal"><span class="pre">nl</span></tt>. Again, all arithmetic predicates are binary, using polish notation, and the allowed predicates are:</p>
<blockquote>
<ul class="simple">
<li>equality: <tt class="docutils literal"><span class="pre">=</span></tt>;</li>
<li>inequality: <tt class="docutils literal"><span class="pre">!=</span></tt>;</li>
<li>less than: <tt class="docutils literal"><span class="pre">&lt;</span></tt>;</li>
<li>less or equal than: <tt class="docutils literal"><span class="pre">&lt;=</span></tt>;</li>
<li>greater than: <tt class="docutils literal"><span class="pre">&gt;</span></tt>;</li>
<li>greater or equal than: <tt class="docutils literal"><span class="pre">&gt;=</span></tt>;</li>
</ul>
</blockquote>
<p>Let&#8217;s give an example, such as &#8220;a person can only enter the &#8216;Momentos&#8217; club if older than 18&#8221;. For this, we will define 3 verbs: &#8220;aged&#8221;, &#8220;enter&#8221;, and &#8220;can&#8221;, a noun &#8220;club&#8221;, and a club &#8220;momentos&#8221;.</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nl</span> <span class="kn">import</span> <span class="n">Arith</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Aged</span><span class="p">(</span><span class="n">Exists</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">subject</span> <span class="o">=</span> <span class="n">HumanBeing</span>
<span class="gp">... </span>    <span class="n">mods</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;years&#39;</span><span class="p">:</span> <span class="n">Number</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Club</span><span class="p">(</span><span class="n">Thing</span><span class="p">):</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Enter</span><span class="p">(</span><span class="n">Exists</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">subject</span> <span class="o">=</span> <span class="n">HumanBeing</span>
<span class="gp">... </span>    <span class="n">mods</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;where&#39;</span><span class="p">:</span> <span class="n">Club</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">momentos</span> <span class="o">=</span> <span class="n">Club</span><span class="p">(</span><span class="s">&#39;momentos&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">momentos</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Can</span><span class="p">(</span><span class="n">Exists</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">subject</span> <span class="o">=</span> <span class="n">HumanBeing</span>
<span class="gp">... </span>    <span class="n">mods</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;what&#39;</span><span class="p">:</span> <span class="n">Exists</span><span class="p">}</span>
<span class="gp">... </span>    <span class="n">instantaneous</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
</blockquote>
<p>Now we define our rule:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r5</span> <span class="o">=</span> <span class="n">Rule</span><span class="p">([</span>
<span class="gp">... </span>     <span class="n">Fact</span><span class="p">(</span><span class="n">HumanBeing</span><span class="p">(</span><span class="s">&#39;H1&#39;</span><span class="p">),</span> <span class="n">Aged</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="s">&#39;X1&#39;</span><span class="p">),</span> <span class="s">&#39;I1&#39;</span><span class="p">),</span>
<span class="gp">... </span>     <span class="n">Arith</span><span class="p">(</span><span class="s">&#39;(&gt; X1 18)&#39;</span><span class="p">)</span>
<span class="gp">... </span>          <span class="p">],[</span>
<span class="gp">... </span>     <span class="n">Fact</span><span class="p">(</span><span class="n">HumanBeing</span><span class="p">(</span><span class="s">&#39;H1&#39;</span><span class="p">),</span> <span class="n">Can</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">Enter</span><span class="p">(</span><span class="n">where</span><span class="o">=</span><span class="n">momentos</span><span class="p">)),</span> <span class="n">Duration</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">&#39;I1&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">&#39;now&#39;</span><span class="p">))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">r5</span><span class="p">)</span>
</pre></div>
</div>
<p>As can be expected from our discussion on <em>time  expressions</em>, the duration given to the consecuence of the previous rule could be tranlated to English as &#8220;from I1 onwards&#8221;.</p>
<p>If we now assert these couple of facts:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">sean</span> <span class="o">=</span> <span class="n">HumanBeing</span><span class="p">(</span><span class="s">&#39;sean&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">sean</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">Aged</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="mi">40</span><span class="p">),</span> <span class="s">&#39;now&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">sean</span><span class="p">,</span> <span class="n">Aged</span><span class="p">(</span><span class="n">years</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="s">&#39;now&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">extend</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>We have that</p>
<blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">john</span><span class="p">,</span> <span class="n">Can</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">Enter</span><span class="p">(</span><span class="n">where</span><span class="o">=</span><span class="n">momentos</span><span class="p">)),</span> <span class="s">&#39;now&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">kb</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">Fact</span><span class="p">(</span><span class="n">sean</span><span class="p">,</span> <span class="n">Can</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="n">Enter</span><span class="p">(</span><span class="n">where</span><span class="o">=</span><span class="n">momentos</span><span class="p">)),</span> <span class="s">&#39;now&#39;</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</blockquote>
<p>Note that, in queries, we can provide an instant in a fact that has a non-instantaneous verb. nl will answer taking into account whether that instant is whithin the interval that it has stored in its kb.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Arithmetics</a><ul>
<li><a class="reference internal" href="#arithetic-conditions">Arithetic conditions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="rules.html"
                        title="previous chapter">Rules - basic</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="special_conditions.html"
                        title="next chapter">More special conditions</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/arithmetics.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="special_conditions.html" title="More special conditions"
             >next</a> |</li>
        <li class="right" >
          <a href="rules.html" title="Rules - basic"
             >previous</a> |</li>
        <li><a href="index.html">nlproject v1.0dev documentation</a> &raquo;</li>
          <li><a href="nl_intro.html" >Documentation for nl</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Enrique Pablo Pérez Arnaud &lt;enriquepablo at google&#39;s mail domain&gt;.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0b2.
    </div>
  </body>
</html>